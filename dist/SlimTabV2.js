var SlimTabV2=function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";var n;i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r}),function(t){t.setAttributes=function(t,e){for(let i in e)t.setAttribute(i,e[i])},t.setStyle=function(t,e){for(let i in e)t.style.setProperty(i,e[i])}}(n||(n={}));class s{constructor(){this.funcs=[]}call(...t){this.funcs.forEach(e=>{e(...t)})}push(t){this.funcs.push(t)}}class r{constructor(t){t.forEach(t=>{this[t]=new s})}}},,function(t,e,i){"use strict";i.r(e),i.d(e,"SLTab",function(){return s});var n=i(0);class s{constructor(t){this.lengthPerBeat=4,this.beatPerSection=4,this.sectionWidth=400,this.sectionPerLine=2,this.stringPadding=16,this.linePerPage=20,this.lineMargin=42,this.linePadding=32,this.noteElement=[],this.startPosition=[this.lineMargin+this.linePadding+20,134],this.lineInfo=[0,this.lineMargin,120],Object.assign(this,t)}setNoteData(t){this.notes=t}addNote(t,e){if(-1==t){let t=this.notes.length,i=this.lengthPerBeat/e[0];for(let e=0;e<this.notes[t-1].length;e++)i+=this.lengthPerBeat/this.notes[t-1][e][0];i>this.beatPerSection?this.notes.push([e]):this.notes[t-1].push(e)}else this.notes[t].push(e);this.render()}render(t){if(!this.svgElement){let e=document.createElement("div"),i=this.sectionWidth*this.sectionPerLine+2*this.linePadding+84;e.setAttribute("style","position: relative; background: radial-gradient(#3E3E3E, #000) ; width: fit-content;"),this.svgElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),n.b.setAttributes(this.svgElement,{width:`${i}`,height:"600"}),e.append(this.svgElement),t.appendChild(e)}this.drawAllLine(),this.setAllNoteElementData(this.calNoteRawData())}drawAllLine(){let t=Math.ceil(this.notes.length/this.sectionPerLine);if(t>this.lineInfo[0])for(let e=0;e<t-this.lineInfo[0];e++)this.drawLine(this.lineInfo[1],this.lineInfo[2]),this.lineInfo[2]+=5*this.stringPadding+80;this.lineInfo[0]=t}drawLine(t,e){let i=document.createElementNS("http://www.w3.org/2000/svg","g"),s=document.createElementNS("http://www.w3.org/2000/svg","rect");n.b.setAttributes(s,{x:`${t}`,y:`${e}`,style:"fill: rgba(255, 255, 255, 0.09)",width:`${2*this.linePadding+this.sectionWidth*this.sectionPerLine}`,height:`${28+5*this.stringPadding}`}),i.appendChild(s),t+=this.linePadding,e+=14;for(let s=0;s<6;s++){let r=this.sectionPerLine*this.sectionWidth,l=document.createElementNS("http://www.w3.org/2000/svg","line");n.b.setAttributes(l,{x1:`${t}`,y1:`${e+s*this.stringPadding}`,x2:`${t+r}`,y2:`${e+s*this.stringPadding}`,style:"stroke:rgba(255, 255, 255, 0.24) ;stroke-width:2"}),i.appendChild(l)}i.appendChild(this.drawLineTitle(t-30,e)),i.appendChild(this.drawBar(t,e));for(let n=1;n<this.sectionPerLine+1;n++)i.appendChild(this.drawBar(t+this.sectionWidth*n,e));this.svgElement.appendChild(i)}drawLineTitle(t,e){let i=document.createElementNS("http://www.w3.org/2000/svg","g");return i.innerHTML=`\n        <text style="fill:#959595;font:17px arial;">\n            <tspan x='${t+10}' y='${e+26}'>T</tspan>\n            <tspan x='${t+10}' y='${e+22+26}'>A</tspan>\n            <tspan x='${t+10}' y='${e+44+26}'>B</tspan>\n        </text>\n        `,i}drawBar(t,e){let i=document.createElementNS("http://www.w3.org/2000/svg","line");return n.b.setAttributes(i,{style:"stroke:rgba(255, 255, 255, 0.24) ;stroke-width:2"}),n.b.setAttributes(i,{x1:`${t}`,y1:`${e}`,x2:`${t}`,y2:`${e+5*this.stringPadding}`}),i}createNoteElement(t=200,e=20){let i=document.createElementNS("http://www.w3.org/2000/svg","g"),n=`<g>\n        <line style="stroke:white;stroke-width:1" x1="${t}" y1="140" x2="${t}" y2="${e}"></line>\n        <line style="stroke:white;stroke-width:2" x1="${t}" y1="138" x2="${t+10}" y2="138"></line>\n        <line style="stroke:white;stroke-width:2" x1="${t}" y1="130" x2="${t+10}" y2="130"></line>\n        <line style="stroke:white;stroke-width:2"></line>\n        </g>`;for(let i=0;i<6;i++)n+=`\n                <g>\n                <ellipse cx='${t}' cy='${e+this.stringPadding*i}' rx='4' ry='6' fill='#444' stroke-width='0' stroke='black' style='cursor:pointer;'></ellipse>\n                <text x='${t}' y='${e+this.stringPadding*i+4}' text-anchor="middle" style="font:12px Sans-serif; fill:#fff">3</text>\n                </g>\n            `;i.innerHTML=n,this.svgElement.appendChild(i),this.noteElement.push(i)}calNoteRawData(){let[t,e]=this.startPosition,i=(this.sectionWidth-20)/this.beatPerSection,n=[];for(let s=0;s<this.notes.length;s++){s%this.sectionPerLine==0&&(t=this.startPosition[0],0!=s&&(e+=5*this.stringPadding+80));let r=t+this.sectionWidth;for(let r=0;r<this.notes[s].length;r++){let l=this.notes[s][r];n.push([t,e,l[0],l[1]]),t+=i*this.lengthPerBeat/l[0]}t=r}return n}setAllNoteElementData(t){let e=t.length-this.noteElement.length;for(let t=0;t<e;t++)this.createNoteElement();for(let e=0;e<t.length;e++)this.setNoteElementData(this.noteElement[e],t[e])}setNoteElementData(t,e){this.setElementPosition(t,e[0],e[1]),this.setNoteBar(t,e[2]),this.setChordVisiable(t,e[0],e[1],e[3])}setElementPosition(t,e,i){n.b.setAttributes(t.children[0].children[0],{x1:`${e}`,y1:`${26+i+5*this.stringPadding}`,x2:`${e}`,y2:`${i}`}),n.b.setAttributes(t.children[0].children[1],{x1:`${e}`,y1:`${25+i+5*this.stringPadding}`,x2:`${e+10}`,y2:`${25+i+5*this.stringPadding}`}),n.b.setAttributes(t.children[0].children[2],{x1:`${e}`,y1:`${21+i+5*this.stringPadding}`,x2:`${e+10}`,y2:`${21+i+5*this.stringPadding}`}),n.b.setAttributes(t.children[0].children[3],{x1:`${e}`,y1:`${17+i+5*this.stringPadding}`,x2:`${e+10}`,y2:`${17+i+5*this.stringPadding}`});for(let s=1;s<=6;s++)n.b.setAttributes(t.children[s].children[0],{cx:`${e}`,cy:`${i+this.stringPadding*(s-1)}`}),n.b.setAttributes(t.children[s].children[1],{x:`${e}`,y:`${i+this.stringPadding*(s-1)+4}`})}setNoteBar(t,e){let i=e/this.lengthPerBeat;i>1.9?n.b.setStyle(t.children[0].children[1],{display:"block"}):n.b.setStyle(t.children[0].children[1],{display:"none"}),i>3.9?n.b.setStyle(t.children[0].children[2],{display:"block"}):n.b.setStyle(t.children[0].children[2],{display:"none"}),i>7.9?n.b.setStyle(t.children[0].children[3],{display:"block"}):n.b.setStyle(t.children[0].children[3],{display:"none"})}setChordVisiable(t,e,i,s){for(let e=1;e<=6;e++)t.children[e].children[1].innerHTML=`${s[e-1]}`,-1==s[e-1]?(n.b.setStyle(t.children[e].children[0],{display:"none"}),n.b.setStyle(t.children[e].children[1],{display:"none"})):(n.b.setStyle(t.children[e].children[0],{display:"block"}),n.b.setStyle(t.children[e].children[1],{display:"block"}));let r=-1;for(let t=0;t<6;t++)if(-1!=s[t]){r=t;break}-1!=r?(n.b.setAttributes(t.children[0].children[0],{y2:`${i+this.stringPadding*r}`}),n.b.setStyle(t.children[0].children[0],{display:"block"})):n.b.setStyle(t.children[0].children[0],{display:"none"})}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9bbmFtZV0vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vW25hbWVdLy4vc3JjL3V0aWxzLnRzIiwid2VicGFjazovL1tuYW1lXS8uL3NyYy9TbGltVGFiVjIudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJ1dGlscyIsIl9fd2VicGFja19leHBvcnRzX18iLCJDYWxsYmFja3MiLCJzZXRBdHRyaWJ1dGVzIiwiZWwiLCJhdHRyIiwiayIsInNldEF0dHJpYnV0ZSIsInNldFN0eWxlIiwic3R5bGUiLCJzZXRQcm9wZXJ0eSIsIkFycmF5RnVuY3Rpb24iLCJbb2JqZWN0IE9iamVjdF0iLCJ0aGlzIiwiZnVuY3MiLCJhcmdzIiwiZm9yRWFjaCIsImZ1bmMiLCJjYmsiLCJwdXNoIiwiZXZlbnRUeXBlIiwiZWxlbWVudCIsIlNMVGFiIiwiX3V0aWxzX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJkYXRhIiwibGVuZ3RoUGVyQmVhdCIsImJlYXRQZXJTZWN0aW9uIiwic2VjdGlvbldpZHRoIiwic2VjdGlvblBlckxpbmUiLCJzdHJpbmdQYWRkaW5nIiwibGluZVBlclBhZ2UiLCJsaW5lTWFyZ2luIiwibGluZVBhZGRpbmciLCJub3RlRWxlbWVudCIsInN0YXJ0UG9zaXRpb24iLCJsaW5lSW5mbyIsImFzc2lnbiIsIm5vdGVzIiwic2VjdGlvbiIsIm5sIiwibGVuZ3RoIiwidGwiLCJyZW5kZXIiLCJhbmNob3IiLCJzdmdFbGVtZW50IiwicGFnZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIndpZHRoIiwiY3JlYXRlRWxlbWVudE5TIiwiaGVpZ2h0IiwiYXBwZW5kIiwiYXBwZW5kQ2hpbGQiLCJkcmF3QWxsTGluZSIsInNldEFsbE5vdGVFbGVtZW50RGF0YSIsImNhbE5vdGVSYXdEYXRhIiwibG4iLCJNYXRoIiwiY2VpbCIsImRyYXdMaW5lIiwieCIsInkiLCJuZyIsImxpbmVCYWNrIiwibmV3TGluZSIsIngxIiwieTEiLCJ4MiIsInkyIiwiZHJhd0xpbmVUaXRsZSIsImRyYXdCYXIiLCJ0aXRsZSIsImlubmVySFRNTCIsImJhciIsIm5vdGUiLCJub3RlSHRtbCIsImJlYXRMZW5ndGgiLCJyYXdEYXRhIiwibngiLCJuZSIsImNyZWF0ZU5vdGVFbGVtZW50Iiwic2V0Tm90ZUVsZW1lbnREYXRhIiwic2V0RWxlbWVudFBvc2l0aW9uIiwic2V0Tm90ZUJhciIsInNldENob3JkVmlzaWFibGUiLCJlIiwiY2hpbGRyZW4iLCJjeCIsImN5IiwibGYiLCJkaXNwbGF5IiwiaGMiXSwibWFwcGluZ3MiOiIwQkFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUEwRGYsT0FyREFGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFB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cEIsY0FBY2tGLEVBQUVDLFNBQVMsR0FBR0EsU0FBUyxHQUFHLENBQUNsQixNQUFPUCxFQUFJaEQsS0FBS2dCLGNBQWdCOEQsTUFDL0VwRSxFQUFBLEVBQU1mLFNBQXNCNkUsRUFBRUMsU0FBUyxHQUFHQSxTQUFTLEdBQUcsQ0FBQ0ksUUFBUyxXQUVoRW5FLEVBQUEsRUFBTWYsU0FBc0I2RSxFQUFFQyxTQUFTLEdBQUdBLFNBQVMsR0FBRyxDQUFDSSxRQUFTIiwiZmlsZSI6IlNsaW1UYWJWMi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAyKTtcbiIsImV4cG9ydCBuYW1lc3BhY2UgdXRpbHMge1xyXG4gICAgZXhwb3J0IGZ1bmN0aW9uIHNldEF0dHJpYnV0ZXMoZWw6IEVsZW1lbnQsIGF0dHI6e1trZXk6IHN0cmluZ106IHN0cmluZ30pe1xyXG4gICAgICAgIGZvcihsZXQgayBpbiBhdHRyKXtcclxuICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKGssIGF0dHJba10pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBzZXRTdHlsZShlbDogSFRNTEVsZW1lbnQsIHN0eWxlOntba2V5OiBzdHJpbmddOiBzdHJpbmd9KXtcclxuICAgICAgICBmb3IobGV0IGsgaW4gc3R5bGUpe1xyXG4gICAgICAgICAgICBlbC5zdHlsZS5zZXRQcm9wZXJ0eShrLCBzdHlsZVtrXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBBcnJheUZ1bmN0aW9uIHtcclxuICAgIHByaXZhdGUgZnVuY3M6IEFycmF5PEZ1bmN0aW9uPiA9IFtdO1xyXG4gICAgY2FsbCguLi5hcmdzOiBhbnlbXSkge1xyXG4gICAgICAgIHRoaXMuZnVuY3MuZm9yRWFjaCgoZnVuYykgPT4ge1xyXG4gICAgICAgICAgICBmdW5jKC4uLmFyZ3MpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcHVzaChjYms6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZnVuY3MucHVzaChjYmspO1xyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNsYXNzIENhbGxiYWNrcyB7XHJcbiAgICBba2V5OiBzdHJpbmddOiBBcnJheUZ1bmN0aW9uO1xyXG4gICAgY29uc3RydWN0b3IoZXZlbnRUeXBlOiBBcnJheTxzdHJpbmc+KSB7XHJcbiAgICAgICAgZXZlbnRUeXBlLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXNbZWxlbWVudF0gPSBuZXcgQXJyYXlGdW5jdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbiIsIi8vVGFibGF0dXJlXHJcbmltcG9ydCB7dXRpbHN9IGZyb20gXCIuL3V0aWxzXCJcclxuZXhwb3J0IGNsYXNzIFNMVGFiIHtcclxuICAgIHByaXZhdGUgbGVuZ3RoUGVyQmVhdDogbnVtYmVyID0gNDtcclxuICAgIHByaXZhdGUgYmVhdFBlclNlY3Rpb246IG51bWJlciA9IDQ7XHJcbiAgICBwcml2YXRlIHNlY3Rpb25XaWR0aDogbnVtYmVyID0gNDAwOyAvLyB1bml0IGluIHBpeGVsXHJcbiAgICBwcml2YXRlIHNlY3Rpb25QZXJMaW5lOiBudW1iZXIgPSAyO1xyXG4gICAgcHJpdmF0ZSBzdHJpbmdQYWRkaW5nOiBudW1iZXIgPSAxNjtcclxuICAgIHByaXZhdGUgbGluZVBlclBhZ2U6IG51bWJlciA9IDIwO1xyXG4gICAgcHJpdmF0ZSBsaW5lTWFyZ2luOiBudW1iZXIgPSA0MjtcclxuICAgIHByaXZhdGUgbGluZVBhZGRpbmc6IG51bWJlciA9IDMyO1xyXG4gICAgcHJpdmF0ZSBub3RlczogW251bWJlciwgbnVtYmVyW10sIGFueV1bXVtdO1xyXG4gICAgcHJpdmF0ZSBub3RlRWxlbWVudDogU1ZHRWxlbWVudFtdID0gW107XHJcbiAgICBwcml2YXRlIHN2Z0VsZW1lbnQ6IFNWR0VsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHN0YXJ0UG9zaXRpb246IG51bWJlcltdID0gW3RoaXMubGluZU1hcmdpbiArIHRoaXMubGluZVBhZGRpbmcgKyAyMCwgMTIwICsgMTRdOyAvLyB4LCB5XHJcbiAgICBwcml2YXRlIGxpbmVJbmZvOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlcl0gPSBbMCwgdGhpcy5saW5lTWFyZ2luLCAxMjBdOyAvLyB0b3RhbCBsaW5lIG51bWJlciwgbGFzdCBsaW5lIFgsIGxhc3QgbGluZSBZXHJcblxyXG4gICAgY29uc3RydWN0b3IoZGF0YT86IHtsZW5ndGhQZXJCZWF0PzogbnVtYmVyLCBiZWF0UGVyU2VjdGlvbj86IG51bWJlciwgc2VjdGlvbldpZHRoPzogbnVtYmVyLCBzZWN0aW9uUGVyTGluZT86IG51bWJlciwgbGluZVBlclBhZ2U/OiBudW1iZXJ9KSB7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXROb3RlRGF0YShkYXRhOiBbbnVtYmVyLCBudW1iZXJbXSwgYW55XVtdW10pIHtcclxuICAgICAgICB0aGlzLm5vdGVzID0gZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBhZGROb3RlKHNlY3Rpb246IG51bWJlciwgZGF0YTogW251bWJlciwgbnVtYmVyW10sIGFueV0pIHsgLy8gaWYgc2VjdGlvbiA9PSAtMSwgbm90ZSB3aWxsIGJlIGFwcGVuZGVkIGF0IGxhc3Qgc2VjdGlvblxyXG4gICAgICAgIGlmKHNlY3Rpb24gPT0gLTEpe1xyXG4gICAgICAgICAgICBsZXQgbmwgPSB0aGlzLm5vdGVzLmxlbmd0aDtcclxuICAgICAgICAgICAgbGV0IHRsID0gdGhpcy5sZW5ndGhQZXJCZWF0IC8gZGF0YVswXTtcclxuICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMubm90ZXNbbmwtMV0ubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgdGwgKz0gdGhpcy5sZW5ndGhQZXJCZWF0IC8gdGhpcy5ub3Rlc1tubC0xXVtpXVswXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0bCA+IHRoaXMuYmVhdFBlclNlY3Rpb24pe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub3Rlcy5wdXNoKFtkYXRhXSk7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ub3Rlc1tubC0xXS5wdXNoKGRhdGEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMubm90ZXNbc2VjdGlvbl0ucHVzaChkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmVuZGVyKGFuY2hvcj86IEVsZW1lbnQpIHtcclxuICAgICAgICBpZighdGhpcy5zdmdFbGVtZW50KXtcclxuICAgICAgICAgICAgbGV0IHBhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBsZXQgd2lkdGggPSB0aGlzLnNlY3Rpb25XaWR0aCAqIHRoaXMuc2VjdGlvblBlckxpbmUgKyB0aGlzLmxpbmVQYWRkaW5nKjIgKyA0MioyO1xyXG4gICAgICAgICAgICBwYWdlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsYHBvc2l0aW9uOiByZWxhdGl2ZTsgYmFja2dyb3VuZDogcmFkaWFsLWdyYWRpZW50KCMzRTNFM0UsICMwMDApIDsgd2lkdGg6IGZpdC1jb250ZW50O2ApO1xyXG4gICAgICAgICAgICB0aGlzLnN2Z0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyxcInN2Z1wiKTtcclxuICAgICAgICAgICAgdXRpbHMuc2V0QXR0cmlidXRlcyh0aGlzLnN2Z0VsZW1lbnQse3dpZHRoOiBgJHt3aWR0aH1gLCBoZWlnaHQ6IFwiNjAwXCJ9KTtcclxuICAgICAgICAgICAgcGFnZS5hcHBlbmQodGhpcy5zdmdFbGVtZW50KTtcclxuICAgICAgICAgICAgYW5jaG9yLmFwcGVuZENoaWxkKHBhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRyYXdBbGxMaW5lKCk7XHJcbiAgICAgICAgdGhpcy5zZXRBbGxOb3RlRWxlbWVudERhdGEodGhpcy5jYWxOb3RlUmF3RGF0YSgpKTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgZHJhd0FsbExpbmUoKSB7XHJcbiAgICAgICAgbGV0IGxuID0gTWF0aC5jZWlsKHRoaXMubm90ZXMubGVuZ3RoIC8gdGhpcy5zZWN0aW9uUGVyTGluZSk7XHJcbiAgICAgICAgaWYobG4gPiB0aGlzLmxpbmVJbmZvWzBdKXtcclxuICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGxuIC0gdGhpcy5saW5lSW5mb1swXTsgaSsrKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuZHJhd0xpbmUodGhpcy5saW5lSW5mb1sxXSwgdGhpcy5saW5lSW5mb1syXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxpbmVJbmZvWzJdICs9IHRoaXMuc3RyaW5nUGFkZGluZyAqIDUgKyA4MDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmxpbmVJbmZvWzBdID0gbG47XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGRyYXdMaW5lKHg6IG51bWJlciwgeTogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IG5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsXCJnXCIpO1xyXG4gICAgICAgIGxldCBsaW5lQmFjayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLFwicmVjdFwiKTtcclxuICAgICAgICB1dGlscy5zZXRBdHRyaWJ1dGVzKGxpbmVCYWNrLHt4OiBgJHt4fWAsIHk6YCR7eX1gLHN0eWxlOiBcImZpbGw6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wOSlcIiwgd2lkdGg6YCR7dGhpcy5saW5lUGFkZGluZyoyICsgdGhpcy5zZWN0aW9uV2lkdGggKiB0aGlzLnNlY3Rpb25QZXJMaW5lfWAsIGhlaWdodDogYCR7MTQqMiArIHRoaXMuc3RyaW5nUGFkZGluZyAqIDV9YH0pO1xyXG4gICAgICAgIG5nLmFwcGVuZENoaWxkKGxpbmVCYWNrKTtcclxuICAgICAgICB4ICs9IHRoaXMubGluZVBhZGRpbmc7XHJcbiAgICAgICAgeSArPSAxNDtcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgNjsgaSsrKXtcclxuICAgICAgICAgICAgbGV0IGwgPSB0aGlzLnNlY3Rpb25QZXJMaW5lICogdGhpcy5zZWN0aW9uV2lkdGg7XHJcbiAgICAgICAgICAgIGxldCBuZXdMaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsXCJsaW5lXCIpO1xyXG4gICAgICAgICAgICB1dGlscy5zZXRBdHRyaWJ1dGVzKG5ld0xpbmUse3gxOiBgJHt4fWAsIHkxOiBgJHt5ICsgaSp0aGlzLnN0cmluZ1BhZGRpbmd9YCwgeDI6IGAke3ggKyBsfWAsIHkyOiBgJHt5ICsgaSp0aGlzLnN0cmluZ1BhZGRpbmd9YCwgc3R5bGU6IFwic3Ryb2tlOnJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yNCkgO3N0cm9rZS13aWR0aDoyXCJ9KTtcclxuICAgICAgICAgICAgbmcuYXBwZW5kQ2hpbGQobmV3TGluZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5nLmFwcGVuZENoaWxkKHRoaXMuZHJhd0xpbmVUaXRsZSh4IC0gMzAsIHkpKTtcclxuXHJcbiAgICAgICAgbmcuYXBwZW5kQ2hpbGQodGhpcy5kcmF3QmFyKHggLCB5KSk7XHJcbiAgICAgICAgZm9yKGxldCBpID0gMTsgaSA8IHRoaXMuc2VjdGlvblBlckxpbmUgKyAxOyBpKyspe1xyXG4gICAgICAgICAgICBuZy5hcHBlbmRDaGlsZCh0aGlzLmRyYXdCYXIoeCArIHRoaXMuc2VjdGlvbldpZHRoKmksIHkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdmdFbGVtZW50LmFwcGVuZENoaWxkKG5nKTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgZHJhd0xpbmVUaXRsZSh4OiBudW1iZXIsIHk6IG51bWJlcik6IFNWR0VsZW1lbnQge1xyXG4gICAgICAgIGxldCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLFwiZ1wiKTtcclxuICAgICAgICB0aXRsZS5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgPHRleHQgc3R5bGU9XCJmaWxsOiM5NTk1OTU7Zm9udDoxN3B4IGFyaWFsO1wiPlxyXG4gICAgICAgICAgICA8dHNwYW4geD0nJHt4ICsgMTB9JyB5PScke3kgKyAyNn0nPlQ8L3RzcGFuPlxyXG4gICAgICAgICAgICA8dHNwYW4geD0nJHt4ICsgMTB9JyB5PScke3kgKyAyMiArIDI2fSc+QTwvdHNwYW4+XHJcbiAgICAgICAgICAgIDx0c3BhbiB4PScke3ggKyAxMH0nIHk9JyR7eSArIDQ0ICsgMjZ9Jz5CPC90c3Bhbj5cclxuICAgICAgICA8L3RleHQ+XHJcbiAgICAgICAgYDtcclxuICAgICAgICByZXR1cm4gdGl0bGU7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGRyYXdCYXIoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBTVkdFbGVtZW50IHtcclxuICAgICAgICBsZXQgYmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsXCJsaW5lXCIpO1xyXG4gICAgICAgIHV0aWxzLnNldEF0dHJpYnV0ZXMoYmFyLHtzdHlsZTogJ3N0cm9rZTpyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMjQpIDtzdHJva2Utd2lkdGg6Mid9KVxyXG4gICAgICAgIHV0aWxzLnNldEF0dHJpYnV0ZXMoYmFyLHt4MTogYCR7eH1gLCB5MTogYCR7eX1gLCB4MjogYCR7eH1gLCB5MjogYCR7eSArIHRoaXMuc3RyaW5nUGFkZGluZyAqIDV9YH0pXHJcbiAgICAgICAgcmV0dXJuIGJhcjtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNyZWF0ZU5vdGVFbGVtZW50KHg6IG51bWJlciA9IDIwMCwgeTpudW1iZXIgPSAyMCl7XHJcbiAgICAgICAgbGV0IG5vdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyxcImdcIik7XHJcbiAgICAgICAgbGV0IG5vdGVIdG1sID0gYDxnPlxyXG4gICAgICAgIDxsaW5lIHN0eWxlPVwic3Ryb2tlOndoaXRlO3N0cm9rZS13aWR0aDoxXCIgeDE9XCIke3h9XCIgeTE9XCIxNDBcIiB4Mj1cIiR7eH1cIiB5Mj1cIiR7eX1cIj48L2xpbmU+XHJcbiAgICAgICAgPGxpbmUgc3R5bGU9XCJzdHJva2U6d2hpdGU7c3Ryb2tlLXdpZHRoOjJcIiB4MT1cIiR7eH1cIiB5MT1cIjEzOFwiIHgyPVwiJHt4KzEwfVwiIHkyPVwiMTM4XCI+PC9saW5lPlxyXG4gICAgICAgIDxsaW5lIHN0eWxlPVwic3Ryb2tlOndoaXRlO3N0cm9rZS13aWR0aDoyXCIgeDE9XCIke3h9XCIgeTE9XCIxMzBcIiB4Mj1cIiR7eCsxMH1cIiB5Mj1cIjEzMFwiPjwvbGluZT5cclxuICAgICAgICA8bGluZSBzdHlsZT1cInN0cm9rZTp3aGl0ZTtzdHJva2Utd2lkdGg6MlwiPjwvbGluZT5cclxuICAgICAgICA8L2c+YDtcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgNiA7IGkrKyl7XHJcbiAgICAgICAgICAgIG5vdGVIdG1sICs9IGBcclxuICAgICAgICAgICAgICAgIDxnPlxyXG4gICAgICAgICAgICAgICAgPGVsbGlwc2UgY3g9JyR7eH0nIGN5PScke3kgKyB0aGlzLnN0cmluZ1BhZGRpbmcgKiBpfScgcng9JzQnIHJ5PSc2JyBmaWxsPScjNDQ0JyBzdHJva2Utd2lkdGg9JzAnIHN0cm9rZT0nYmxhY2snIHN0eWxlPSdjdXJzb3I6cG9pbnRlcjsnPjwvZWxsaXBzZT5cclxuICAgICAgICAgICAgICAgIDx0ZXh0IHg9JyR7eCB9JyB5PScke3kgKyB0aGlzLnN0cmluZ1BhZGRpbmcgKiBpICsgNH0nIHRleHQtYW5jaG9yPVwibWlkZGxlXCIgc3R5bGU9XCJmb250OjEycHggU2Fucy1zZXJpZjsgZmlsbDojZmZmXCI+MzwvdGV4dD5cclxuICAgICAgICAgICAgICAgIDwvZz5cclxuICAgICAgICAgICAgYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbm90ZS5pbm5lckhUTUwgPSBub3RlSHRtbDtcclxuICAgICAgICB0aGlzLnN2Z0VsZW1lbnQuYXBwZW5kQ2hpbGQobm90ZSk7XHJcbiAgICAgICAgdGhpcy5ub3RlRWxlbWVudC5wdXNoKG5vdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2FsTm90ZVJhd0RhdGEoKTogW251bWJlciwgbnVtYmVyLCBudW1iZXIsIG51bWJlcltdXVtdeyAvLyB4LCB5ICwgbGVuZ3RoLCBibG9jayBvZiBldmVyeSBjaG9yZFxyXG4gICAgICAgIGxldCBbeCwgeV0gPSB0aGlzLnN0YXJ0UG9zaXRpb247XHJcbiAgICAgICAgbGV0IGJlYXRMZW5ndGggPSAodGhpcy5zZWN0aW9uV2lkdGggLSAyMCkgLyB0aGlzLmJlYXRQZXJTZWN0aW9uO1xyXG4gICAgICAgIGxldCByYXdEYXRhOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyW11dW10gPSBbXTtcclxuICAgICAgICBmb3IobGV0IHMgPSAwOyBzIDwgdGhpcy5ub3Rlcy5sZW5ndGg7IHMrKyl7IC8vIHNlY3Rpb25cclxuICAgICAgICAgICAgaWYocyAlIHRoaXMuc2VjdGlvblBlckxpbmUgPT0gMCl7XHJcbiAgICAgICAgICAgICAgICB4ID0gdGhpcy5zdGFydFBvc2l0aW9uWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYocyAhPSAwKXkgKz0gdGhpcy5zdHJpbmdQYWRkaW5nICogNSArIDgwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBueCA9IHggKyB0aGlzLnNlY3Rpb25XaWR0aDtcclxuICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IHRoaXMubm90ZXNbc10ubGVuZ3RoOyBpKyspeyAvLyBub3RlXHJcbiAgICAgICAgICAgICAgICBsZXQgbm90ZSA9IHRoaXMubm90ZXNbc11baV07XHJcbiAgICAgICAgICAgICAgICByYXdEYXRhLnB1c2goW3gsIHksIG5vdGVbMF0sIG5vdGVbMV1dKTtcclxuICAgICAgICAgICAgICAgIGxldCBzdGVwID0gYmVhdExlbmd0aCAqIHRoaXMubGVuZ3RoUGVyQmVhdCAvIG5vdGVbMF07XHJcbiAgICAgICAgICAgICAgICB4ICs9IHN0ZXA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgeCA9IG54O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmF3RGF0YTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgc2V0QWxsTm90ZUVsZW1lbnREYXRhKGRhdGE6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyLCBudW1iZXJbXV1bXSl7XHJcbiAgICAgICAgbGV0IG5lID0gZGF0YS5sZW5ndGggLSB0aGlzLm5vdGVFbGVtZW50Lmxlbmd0aDtcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgbmU7IGkrKyl7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTm90ZUVsZW1lbnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICB0aGlzLnNldE5vdGVFbGVtZW50RGF0YSh0aGlzLm5vdGVFbGVtZW50W2ldLCBkYXRhW2ldKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIHNldE5vdGVFbGVtZW50RGF0YShlbDpTVkdFbGVtZW50LCBkYXRhOiBbbnVtYmVyLCBudW1iZXIsIG51bWJlciwgbnVtYmVyW11dKXtcclxuICAgICAgICB0aGlzLnNldEVsZW1lbnRQb3NpdGlvbihlbCwgZGF0YVswXSwgZGF0YVsxXSk7XHJcbiAgICAgICAgdGhpcy5zZXROb3RlQmFyKGVsLCBkYXRhWzJdKTtcclxuICAgICAgICB0aGlzLnNldENob3JkVmlzaWFibGUoZWwsIGRhdGFbMF0sIGRhdGFbMV0sIGRhdGFbM10pO1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBzZXRFbGVtZW50UG9zaXRpb24oZTpTVkdFbGVtZW50LCB4Om51bWJlciwgeTpudW1iZXIpe1xyXG4gICAgICAgIHV0aWxzLnNldEF0dHJpYnV0ZXMoZS5jaGlsZHJlblswXS5jaGlsZHJlblswXSx7eDE6IGAke3h9YCwgeTE6IGAkezI2ICsgeSArIHRoaXMuc3RyaW5nUGFkZGluZyAqIDV9YCwgeDI6IGAke3h9YCwgeTI6IGAke3l9YH0pO1xyXG4gICAgICAgIHV0aWxzLnNldEF0dHJpYnV0ZXMoZS5jaGlsZHJlblswXS5jaGlsZHJlblsxXSx7eDE6IGAke3h9YCwgeTE6IGAkezI1ICsgeSArIHRoaXMuc3RyaW5nUGFkZGluZyAqIDV9YCwgeDI6IGAke3ggKyAxMH1gLCB5MjogYCR7MjUgKyB5ICsgdGhpcy5zdHJpbmdQYWRkaW5nICogNX1gfSk7XHJcbiAgICAgICAgdXRpbHMuc2V0QXR0cmlidXRlcyhlLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzJdLHt4MTogYCR7eH1gLCB5MTogYCR7MjEgKyB5ICsgdGhpcy5zdHJpbmdQYWRkaW5nICogNX1gLCB4MjogYCR7eCArIDEwfWAsIHkyOiBgJHsyMSArIHkgKyB0aGlzLnN0cmluZ1BhZGRpbmcgKiA1fWB9KTtcclxuICAgICAgICB1dGlscy5zZXRBdHRyaWJ1dGVzKGUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bM10se3gxOiBgJHt4fWAsIHkxOiBgJHsxNyArIHkgKyB0aGlzLnN0cmluZ1BhZGRpbmcgKiA1fWAsIHgyOiBgJHt4ICsgMTB9YCwgeTI6IGAkezE3ICsgeSArIHRoaXMuc3RyaW5nUGFkZGluZyAqIDV9YH0pO1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDEgOyBpIDw9IDY7IGkrKyl7XHJcbiAgICAgICAgICAgIHV0aWxzLnNldEF0dHJpYnV0ZXMoZS5jaGlsZHJlbltpXS5jaGlsZHJlblswXSwge2N4OiBgJHt4fWAsIGN5OiBgJHt5ICsgdGhpcy5zdHJpbmdQYWRkaW5nICogKGktMSl9YH0pO1xyXG4gICAgICAgICAgICB1dGlscy5zZXRBdHRyaWJ1dGVzKGUuY2hpbGRyZW5baV0uY2hpbGRyZW5bMV0sIHt4OiBgJHt4fWAsIHk6IGAke3kgKyB0aGlzLnN0cmluZ1BhZGRpbmcgKiAoaS0xKSArIDR9YH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHByaXZhdGUgc2V0Tm90ZUJhcihlOlNWR0VsZW1lbnQsIGxlbmd0aDogbnVtYmVyKXtcclxuICAgICAgICBsZXQgbGYgPSBsZW5ndGggLyB0aGlzLmxlbmd0aFBlckJlYXQ7XHJcbiAgICAgICAgaWYobGYgPiAxLjkpe1xyXG4gICAgICAgICAgICB1dGlscy5zZXRTdHlsZSg8SFRNTEVsZW1lbnQ+ZS5jaGlsZHJlblswXS5jaGlsZHJlblsxXSx7ZGlzcGxheTogXCJibG9ja1wifSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHV0aWxzLnNldFN0eWxlKDxIVE1MRWxlbWVudD5lLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzFdLHtkaXNwbGF5OiBcIm5vbmVcIn0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihsZiA+IDMuOSl7XHJcbiAgICAgICAgICAgIHV0aWxzLnNldFN0eWxlKDxIVE1MRWxlbWVudD5lLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzJdLHtkaXNwbGF5OiBcImJsb2NrXCJ9KTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdXRpbHMuc2V0U3R5bGUoPEhUTUxFbGVtZW50PmUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMl0se2Rpc3BsYXk6IFwibm9uZVwifSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGxmID4gNy45KXtcclxuICAgICAgICAgICAgdXRpbHMuc2V0U3R5bGUoPEhUTUxFbGVtZW50PmUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bM10se2Rpc3BsYXk6IFwiYmxvY2tcIn0pO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB1dGlscy5zZXRTdHlsZSg8SFRNTEVsZW1lbnQ+ZS5jaGlsZHJlblswXS5jaGlsZHJlblszXSx7ZGlzcGxheTogXCJub25lXCJ9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIHNldENob3JkVmlzaWFibGUoZTpTVkdFbGVtZW50LCB4OiBudW1iZXIsIHk6IG51bWJlciwgZGF0YTogbnVtYmVyW10pe1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDEgOyBpIDw9IDY7IGkrKyl7XHJcbiAgICAgICAgICAgIGUuY2hpbGRyZW5baV0uY2hpbGRyZW5bMV0uaW5uZXJIVE1MID0gYCR7ZGF0YVtpLTFdfWA7XHJcbiAgICAgICAgICAgIGlmKGRhdGFbaS0xXSA9PSAtMSl7XHJcbiAgICAgICAgICAgICAgICB1dGlscy5zZXRTdHlsZSg8SFRNTEVsZW1lbnQ+ZS5jaGlsZHJlbltpXS5jaGlsZHJlblswXSx7ZGlzcGxheTogXCJub25lXCJ9KTtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnNldFN0eWxlKDxIVE1MRWxlbWVudD5lLmNoaWxkcmVuW2ldLmNoaWxkcmVuWzFdLHtkaXNwbGF5OiBcIm5vbmVcIn0pO1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnNldFN0eWxlKDxIVE1MRWxlbWVudD5lLmNoaWxkcmVuW2ldLmNoaWxkcmVuWzBdLHtkaXNwbGF5OiBcImJsb2NrXCJ9KTtcclxuICAgICAgICAgICAgICAgIHV0aWxzLnNldFN0eWxlKDxIVE1MRWxlbWVudD5lLmNoaWxkcmVuW2ldLmNoaWxkcmVuWzFdLHtkaXNwbGF5OiBcImJsb2NrXCJ9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaGM6IG51bWJlciA9IC0xO1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDAgOyBpIDwgNjsgaSsrKXtcclxuICAgICAgICAgICAgaWYoZGF0YVtpXSAhPSAtMSl7XHJcbiAgICAgICAgICAgICAgICBoYyA9IGk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfSAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoaGMgIT0gLTEpe1xyXG4gICAgICAgICAgICB1dGlscy5zZXRBdHRyaWJ1dGVzKGUuY2hpbGRyZW5bMF0uY2hpbGRyZW5bMF0se3kyOiBgJHt5ICsgdGhpcy5zdHJpbmdQYWRkaW5nICogaGN9YH0pO1xyXG4gICAgICAgICAgICB1dGlscy5zZXRTdHlsZSg8SFRNTEVsZW1lbnQ+ZS5jaGlsZHJlblswXS5jaGlsZHJlblswXSx7ZGlzcGxheTogXCJibG9ja1wifSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHV0aWxzLnNldFN0eWxlKDxIVE1MRWxlbWVudD5lLmNoaWxkcmVuWzBdLmNoaWxkcmVuWzBdLHtkaXNwbGF5OiBcIm5vbmVcIn0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdLCJzb3VyY2VSb290IjoiIn0=